<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home Concept with MWG 007</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- GSAP and SplitText -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/SplitText.min.js"></script>
    <link rel="stylesheet" href="style.css" />

    <style>
      @keyframes marquee {
        0% {
          transform: translateX(0%);
        }
        100% {
          transform: translateX(-50%);
        }
      }

      .marquee-content {
        display: flex;
        animation: marquee 24s linear infinite;
        width: max-content;
      }

      .marquee-content span {
        flex-shrink: 0;
        padding: 0 12px;
      }

      .split-word {
        display: inline-block;
        opacity: 0.2;
        transition: opacity 0.3s ease;
      }
    </style>
  </head>
  <body class="bg-[#eeebe4]">
    <div
      class="header fixed h-[40px] top-5 w-[calc(100%-96px)] pl-[0px] pr-4 py-3 bg-white bg-opacity-10 backdrop-blur-lg left-1/2 -translate-x-1/2 z-50 border border-[#545247] rounded-full flex items-center justify-between uppercase text-[13px] font-medium tracking-[0.1em]"
    >
      <div class="left-col w-full flex gap-2 items-center justify-start">
        <button class="burger scale-75">
          <img src="assets/medias/burger.svg" alt="burger" />
        </button>
        <a href="">Programok</a>
        <a href="">Helyszín</a>
        <a href="">Hírek</a>
      </div>
      <div class="middle-col w-full flex items-center justify-center">
        <img src="assets/medias/planet-logo.svg" alt="logo" class="h-[20px]" />
      </div>
      <div class="right-col w-full flex gap-2 items-center justify-end">
        <a href="#">Keresés</a>
        <a href="#">HU</a>
      </div>
    </div>
    <div class="hero bg-[#eeebe4] text-[#545247] relative">
      <div class="hero-header bg-[#eeebe4] z-10">
        <div class="logo-container px-12 pt-[148px]">
          <img src="assets/medias/planet-logo.svg" alt="logo" />
        </div>
        <div class="flex w-full items-start justify-between px-12">
          <div class="left-col flex flex-col items-start justify-start">
            <div
              class="marquee origin-top-left flex flex-nowrap w-[182px] rounded-full text-[#EEEBE4] bg-[#83926B] whitespace-nowrap h-[43px] uppercase text-[13px] font-medium tracking-[0.1em] items-center scale-75 overflow-hidden"
            >
              <div class="marquee-content">
                <span>Ingyenes belépés</span>
                <span>Ingyenes belépés</span>
                <span>Ingyenes belépés</span>
                <span>Ingyenes belépés</span>
                <span>Ingyenes belépés</span>
                <span>Ingyenes belépés</span>
                <span>Ingyenes belépés</span>
                <span>Ingyenes belépés</span>
              </div>
            </div>
            <p class="description max-w-[400px] text-[18px]">
              Inspiráló kiállítások és folyamatos workshopok kapcsolják össze a
              kíváncsiságot a tettekkel három fókuszterületen.
            </p>
          </div>
          <a
            href="#"
            class="scale-75 right-col flex items-center uppercase text-[13px] font-medium tracking-[0.1em] gap-[2px] group"
            ><img
              class="scale-0 group-hover:translate-x-[43px] group-hover:scale-100 transition-all duration-300"
              src="assets/medias/arrow-icon-dark.svg"
              alt="arrow"
            />
            <span
              class="group-hover:translate-x-[43px] h-[43px] flex items-center justify-center transition-all duration-300 border border-[#545247] rounded-full px-4 py-2"
              >Foglald le a helyed</span
            >
            <img
              class="group-hover:scale-0 group-hover:translate-x-[43px] transition-all duration-300"
              src="assets/medias/arrow-icon-dark.svg"
              alt="arrow"
            />
          </a>
        </div>
      </div>
      <div class="main-visual z-20 relative">
        <img src="assets/medias/updated-map.png" alt="main-visual" />
      </div>
    </div>

    <div class="description-container h-[150vh] bg-[#eeebe4] ">
      <div
        class="description-pin-container h-screen flex items-center justify-center"
      >
        <p
          class="description-text w-[66%] max-w-[800px] text-center text-[#545247] text-[40px] tracking-[-0.02em] leading-[100%] font-medium"
        >
        A Planet Budapest egy egyedülálló fenntarthatósági rendezvény, amely a jövőformálásról, a tudás és az élmény összekapcsolásáról, valamint a közösségi cselekvés ösztönzéséről szól
        </p>
      </div>
    </div>

    <!-- Text Scroll Web Component -->
    <text-scroll></text-scroll>
    <!-- Scroll Gallery Web Component -->
    <mwg-007></mwg-007>

    <!-- EXPO -->
    <div class="expo-container h-[400vh] bg-[#eeebe4]">
      <div class="expo-pin-container h-screen flex items-center justify-center">
        <div class="expo-content aspect-[16/9] rounded-full w-[50%] bg-red-500 flex items-center justify-center relative overflow-hidden">
          <div class="expo-bg expo-bg-1 absolute inset-0 bg-cover bg-center" style="background-image: url('assets/medias/expo-01.png'); opacity: 1;"></div>
          <div class="expo-bg expo-bg-2 absolute inset-0 bg-cover bg-center" style="background-image: url('assets/medias/expo-02.png'); opacity: 0;"></div>
          <div class="expo-bg expo-bg-3 absolute inset-0 bg-cover bg-center" style="background-image: url('assets/medias/expo-03.png'); opacity: 0;"></div>
          <div class="expo-bg expo-bg-4 absolute inset-0 bg-cover bg-center" style="background-image: url('assets/medias/expo-04.png'); opacity: 0;"></div>
          <div class="expo-bg expo-bg-5 absolute inset-0 bg-cover bg-center" style="background-image: url('assets/medias/expo-05.png'); opacity: 0;"></div>
          <div class="expo-text text-center text-white opacity-0 font-medium text-[96px] tracking-[-0.02em] leading-[100%] absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 whitespace-nowrap">100 stand</div>
          <div class="expo-text text-center text-white opacity-0 font-medium text-[96px] tracking-[-0.02em] leading-[100%] absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 whitespace-nowrap">12 ágazat</div>
          <div class="expo-text text-center text-white opacity-0 font-medium text-[96px] tracking-[-0.02em] leading-[100%] absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 whitespace-nowrap">5 napon át</div>
          <div class="expo-text text-center text-white opacity-0 font-medium text-[40px] tracking-[-0.02em] leading-[100%] absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 whitespace-nowrap"><div class="flex flex-col gap-4 items-center justify-center">
            <img
              class="w-full"
              src="assets/medias/planet-expo.png"
              alt="planet-expo"
            />
            <p class="w-[350px] text-wrap max-w-[400px] text-center text-[18px] leading-[110%]">
              A fenntarthatósági célok megvalósításában élen járó vállalatok, startupok, egyetemek és előadók bemutatkozási tere.
            </p>
            <a
              href="#"
              class="scale-75 right-col flex items-center uppercase text-[13px] font-medium tracking-[0.1em] gap-[2px] group"
              ><img
                class="scale-0 group-hover:translate-x-[43px] group-hover:scale-100 transition-all duration-300"
                src="assets/medias/arrow-right-white.svg"
                alt="arrow"
              />
              <span
                class="group-hover:translate-x-[43px] h-[43px] flex items-center justify-center transition-all duration-300 border border-[white] rounded-full px-4 py-2"
                >Többet az expóról</span
              >
              <img
                class="group-hover:scale-0 group-hover:translate-x-[43px] transition-all duration-300"
                src="assets/medias/arrow-right-white.svg"
                alt="arrow"
              />
            </a>
          </div></div>

        </div>
        </div>
      </div>
    </div>

    <!-- Planet Expo -->
    <!--  <div class="h-screen flex flex-col gap-4 items-center justify-center">
      <img
        class="w-[50%]"
        src="assets/medias/planet-expo.png"
        alt="planet-expo"
      />
      <a
        href="#"
        class="scale-75 right-col flex items-center uppercase text-[13px] font-medium tracking-[0.1em] gap-[2px] group"
        ><img
          class="scale-0 group-hover:translate-x-[43px] group-hover:scale-100 transition-all duration-300"
          src="assets/medias/arrow-icon-dark.svg"
          alt="arrow"
        />
        <span
          class="group-hover:translate-x-[43px] h-[43px] flex items-center justify-center transition-all duration-300 border border-[#545247] rounded-full px-4 py-2"
          >Többet az expóról</span
        >
        <img
          class="group-hover:scale-0 group-hover:translate-x-[43px] transition-all duration-300"
          src="assets/medias/arrow-icon-dark.svg"
          alt="arrow"
        />
      </a>
    </div> -->
    <!-- Parallax Columns Web Component -->
    <parallax-columns></parallax-columns>

    <!-- MWG 024 Web Component -->
    <mwg-024></mwg-024>

    <!-- Load the components -->
    <script src="scroll-gallery.js" type="module"></script>
    <script src="text-scroll.js" type="module"></script>
    <script src="parallax-columns.js" type="module"></script>
    <script src="mwg-024.js" type="module"></script>

    <!-- Main visual scaling animation and sticky header -->
    <script>
      // Wait for GSAP to be loaded by the components
      window.addEventListener("load", () => {
        // Small delay to ensure GSAP is ready
        setTimeout(() => {
          if (window.gsap && window.ScrollTrigger) {
            gsap.registerPlugin(ScrollTrigger);

            // Pin the hero header while the hero section scrolls through
            ScrollTrigger.create({
              trigger: ".hero",
              start: "top top",
              end: "bottom 125%",
              pin: ".hero-header",
              pinSpacing: false,
              onToggle: (self) => {
                // Optional: Add/remove classes when pinning starts/stops
                const headerEl = document.querySelector(".hero-header");
                if (headerEl) {
                  if (self.isActive) {
                    headerEl.classList.add("is-pinned");
                  } else {
                    headerEl.classList.remove("is-pinned");
                  }
                }
              },
            });

            // Pin the description text for 200vh
            ScrollTrigger.create({
              trigger: ".description-container",
              start: "top top",
              end: "bottom 75%",
              pin: ".description-pin-container",
              pinSpacing: false,
            });

            // Split text into words and animate
            function splitTextIntoWords(element) {
              const text = element.textContent.trim();
              const words = text.split(/\s+/).filter((word) => word.length > 0);
              element.innerHTML = words
                .map((word) => `<span class="split-word">${word}</span>`)
                .join(" ");
              return element.querySelectorAll(".split-word");
            }

            // Apply text splitting to description text
            const descriptionText = document.querySelector(".description-text");
            const words = splitTextIntoWords(descriptionText);

            // Animate words opacity based on scroll
            gsap.timeline({
              scrollTrigger: {
                trigger: ".description-container",
                start: "top top",
                end: "bottom 75%",
                scrub: 1,
                onUpdate: (self) => {
                  const progress = self.progress;
                  const totalWords = words.length;
                  const wordsToShow = Math.floor(progress * totalWords);

                  words.forEach((word, index) => {
                    if (index <= wordsToShow) {
                      gsap.to(word, { opacity: 1, duration: 0 });
                    } else {
                      gsap.to(word, { opacity: 0.2, duration: 0 });
                    }
                  });
                },
              },
            });

            // Pin the expo content for 300vh
            ScrollTrigger.create({
              trigger: ".expo-container",
              start: "top top",
              end: "bottom 125%",
              pin: ".expo-pin-container",
              pinSpacing: false,
            });

            // Scale expo content while pinned
            gsap.to(".expo-content", {
              width: "100%",
              height: "100%",
              borderRadius: "0px",
              ease: "power2.inOut",
              scrollTrigger: {
                trigger: ".expo-container",
                start: "top top",
                end: "bottom 125%",
                scrub: 1,
              },
            });

            // Preload all expo images
            const expoImages = [
              "assets/medias/expo-01.png",
              "assets/medias/expo-02.png", 
              "assets/medias/expo-03.png",
              "assets/medias/expo-04.png",
              "assets/medias/expo-05.png"
            ];

            // Preload images to prevent flashing
            expoImages.forEach(src => {
              const img = new Image();
              img.src = src;
            });

            // Cycle through background images 5 times using opacity
            gsap.timeline({
              scrollTrigger: {
                trigger: ".expo-container",
                start: "top top",
                end: "bottom 125%",
                scrub: 1,
                onUpdate: (self) => {
                  const progress = self.progress;
                  
                  let currentImageIndex;
                  
                  // Ensure last image (expo-05) shows at 90% progress and stays
                  if (progress >= 0.9) {
                    currentImageIndex = 4; // expo-05 (index 4)
                  } else {
                    // 4.5 cycles through first 4 images until 90% progress
                    const adjustedProgress = progress / 0.9; // Scale progress to 0-1 for the first 90%
                    const totalCycles = 4.5;
                    const totalImages = 4 * totalCycles; // Only cycle through first 4 images
                    currentImageIndex = Math.floor(adjustedProgress * totalImages) % 4;
                  }
                  
                  // Hide all backgrounds
                  document.querySelectorAll('.expo-bg').forEach(bg => {
                    gsap.set(bg, { opacity: 0 });
                  });
                  
                  // Show current background
                  const currentBg = document.querySelector(`.expo-bg-${currentImageIndex + 1}`);
                  if (currentBg) {
                    gsap.set(currentBg, { opacity: 1 });
                  }
                  
                  // Hide all text first
                  document.querySelectorAll('.expo-text').forEach(text => {
                    gsap.set(text, { opacity: 0 });
                  });
                  
                  // Show text based on progress
                  const totalCycles = 5;
                  const currentCycle = Math.floor(progress * totalCycles);
                  
                  // Cycle 0: no text, Cycle 1: text 1, Cycle 2: text 2, etc.
                  if (currentCycle > 0 && currentCycle <= 4) {
                    const currentText = document.querySelector(`.expo-text:nth-child(${currentCycle + 5})`); // +5 because text divs come after bg divs
                    if (currentText) {
                      gsap.set(currentText, { opacity: 1 });
                    }
                  }
                },
                onLeave: () => {
                  // Keep Text 4 visible when leaving the section
                  document.querySelectorAll('.expo-text').forEach(text => {
                    gsap.set(text, { opacity: 0 });
                  });
                  const lastText = document.querySelector('.expo-text:nth-child(9)'); // Text 4 is the 9th child
                  if (lastText) {
                    gsap.set(lastText, { opacity: 1 });
                  }
                },
                onEnterBack: () => {
                  // Resume normal cycling when scrolling back into section
                  // This will be handled by the onUpdate function
                }
              }
            });

            // Scale background images from 150% to 100%
            gsap.fromTo(".expo-bg", {
              scale: 1.5
            }, {
              scale: 1,
              ease: "none",
              scrollTrigger: {
                trigger: ".expo-container",
                start: "top top",
                end: "bottom 125%",
                scrub: 1,
              },
            });

            // Main visual scaling animation
            gsap.fromTo(
              ".main-visual img",
              {
                scale: 1.15,
              },
              {
                scale: 1.75,
                y: "-25%",
                ease: "none",
                scrollTrigger: {
                  trigger: ".main-visual",
                  start: "top bottom",
                  end: "bottom top",
                  scrub: true,
                },
              }
            );
          }
        }, 100);
      });
    </script>
  </body>
</html>
